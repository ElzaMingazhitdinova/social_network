<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Posts</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
<div id="vue">
    <table align="center" cellspacing="30"><tbody><div class="large-12 medium-12 small-12 cell">
        <tr><th>Post</th><th>Author</th><th>Category</th><th>Date</th></tr>

        <td>{{post.post}}</td><td>{{post.author}}</td><td>{{post.category}}</td><td>{{post.date}}</td>

    </div></tbody></table>
</div>
    <script type="text/javascript">
        const API_URL = 'http://127.0.0.1:8080';
        const router = new VueRouter({
          mode: 'history',
          routes: [
          ]
        });
        var app = new Vue({
            el:'#vue',
            data() {
                return {
                    search_cat: "",
                    search_user: "",
                    post: null,
                    postList: [],
                    sortingList: [],
                    selected: "",
                  };
              },
              computed: {
              },
              mounted() {
                  this.getSortings()
                  this.getPostList("")
              },
              methods: {
                  async getSortings(){
                      const sortingListResp = await this.sortingListRequest();
                      this.sortingList = sortingListResp.data.response;
                      this.selected = this.sortingList[0];
                  },

                  async getPostList(sorting) {
                      const postListResp = await this.postListRequest(sorting);
                      this.postList = postListResp.data.response;
                  },

                  async onSortingChange(sorting) {
                      console.log(sorting);
                      this.getPostList(sorting);
                      console.log(this.postList);
                  },

                  sortingListRequest() {
                      return axios({
                          method: 'get',
                          url: API_URL + '/sorting/list',
                          responseType: 'json',
                      })
                  },

                  postListRequest(sorting) {
                      if (sorting != ""){
                          sorting = "&sorting="+sorting
                      }
                      return axios({
                          method: 'get',
                          url: API_URL + '/post/list?id=1'+sorting,
                          responseType: 'json',
                      })
                  },
                  pushCategorySearch() {
                    window.open('/category/list/page?contains='+this.search_cat);
                  },
                  pushUserSearch() {
                    window.open('/user/list/page?contains='+this.search_user);
                  }
              }
          });
        </script>
</body>
</html>
